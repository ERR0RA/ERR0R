<script>
let currentAnswer = null;
let score = 0;
let answered = false;

function rand(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function generateQuestion() {

    const topic = document.getElementById("topic").value;
    const difficulty = document.getElementById("difficulty").value;
    const questionArea = document.getElementById("questionArea");

    document.getElementById("feedback").innerText = "";
    document.getElementById("answerInput").value = "";

    currentAnswer = null;
    answered = false;

    // ================= RATIO =================
    if (topic === "ratio") {

        if (difficulty === "easy") {
            let a = rand(1,5);
            let b = rand(1,5);
            questionArea.innerHTML = `Simplify the ratio ${a*2}:${b*2}`;
            currentAnswer = `${a}:${b}`;
        }

        else if (difficulty === "medium") {
            let a = rand(1,5);
            let b = rand(1,5);
            let total = (a+b)*rand(2,4);
            let scale = total/(a+b);
            questionArea.innerHTML = `Share £${total} in the ratio ${a}:${b}. How much does the first person get?`;
            currentAnswer = (a*scale).toString();
        }

        else if (difficulty === "hard") {
            let a = rand(2,6);
            let b = rand(2,6);
            let c = rand(2,6);
            questionArea.innerHTML = `Three numbers are in the ratio ${a}:${b}:${c}. Their sum is ${(a+b+c)*5}. Find the largest number.`;
            currentAnswer = (c*5).toString();
        }
    }

    // ================= SIMILAR SHAPES =================
    else if (topic === "similar") {

        if (difficulty === "easy") {
            let scale = rand(2,5);
            let length = rand(2,10);
            questionArea.innerHTML = `Two similar shapes have scale factor ${scale}. If small length is ${length}cm, find the large length.`;
            currentAnswer = (length*scale).toString();
        }

        else if (difficulty === "medium") {
            let scale = rand(2,4);
            let area = rand(10,30);
            questionArea.innerHTML = `Two shapes are similar with scale factor ${scale}. If small area is ${area}cm², find large area.`;
            currentAnswer = (area * scale * scale).toString();
        }

        else if (difficulty === "hard") {
            let scale = rand(2,4);
            let volume = rand(5,20);
            questionArea.innerHTML = `Two similar solids have scale factor ${scale}. If small volume is ${volume}cm³, find large volume.`;
            currentAnswer = (volume * scale * scale * scale).toString();
        }
    }

    else {
        questionArea.innerHTML = "Select a valid topic.";
    }
}

function checkAnswer() {

    if (answered) return;

    let userAnswer = document.getElementById("answerInput").value.replace(/\s+/g,'');
    let correct = currentAnswer;

    if (userAnswer === correct) {
        score++;
        document.getElementById("feedback").innerText = "Correct!";
    } else {
        document.getElementById("feedback").innerText =
            "Incorrect. Correct answer: " + currentAnswer;
    }

    document.getElementById("score").innerText = "Score: " + score;
    answered = true;
}

generateQuestion();
</script>
